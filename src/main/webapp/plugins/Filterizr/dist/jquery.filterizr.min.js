!function(t,r){"use strict";if(!r)throw new Error("Filterizr requires jQuery to work.");var i=function(t){this.init(t)};i.prototype={init:function(t){this.root={x:0,y:0,w:t}},fit:function(t){var r,i,e,n=t.length,o=n>0?t[0].h:0;for(this.root.h=o,r=0;n>r;r++)e=t[r],(i=this.findNode(this.root,e.w,e.h))?e.fit=this.splitNode(i,e.w,e.h):e.fit=this.growDown(e.w,e.h)},findNode:function(t,r,i){return t.used?this.findNode(t.right,r,i)||this.findNode(t.down,r,i):r<=t.w&&i<=t.h?t:null},splitNode:function(t,r,i){return t.used=!0,t.down={x:t.x,y:t.y+i,w:t.w,h:t.h-i},t.right={x:t.x+r,y:t.y,w:t.w-r,h:i},t},growDown:function(t,r){var i;return this.root={used:!0,x:0,y:0,w:this.root.w,h:this.root.h+r,down:{x:0,y:this.root.h,w:this.root.w,h:r},right:this.root},(i=this.findNode(this.root,t,r))?this.splitNode(i,t,r):null}},r.fn.filterizr=function(){var t=this,i=arguments;if(t._fltr||(t._fltr=r.fn.filterizr.prototype.init(t.selector,"object"==typeof i[0]?i[0]:void 0)),"string"==typeof i[0]){if(i[0].lastIndexOf("_")>-1)throw new Error("Filterizr error: You cannot call private methods");if("function"!=typeof t._fltr[i[0]])throw new Error("Filterizr error: There is no such function");t._fltr[i[0]](i[1],i[2])}return t},r.fn.filterizr.prototype={init:function(t,i){var e=r(t).extend(r.fn.filterizr.prototype);return e.options={animationDuration:.5,callbacks:{onFilteringStart:function(){},onFilteringEnd:function(){}},delay:0,delayMode:"progressive",easing:"ease-out",filter:"all",filterOutCss:{opacity:0,transform:"scale(0.5)"},filterInCss:{opacity:1,transform:"scale(1)"},layout:"sameSize",selector:"string"==typeof t?t:".filtr-container",setupControls:!0},0===arguments.length&&(t=e.options.selector,i=e.options),1===arguments.length&&"object"==typeof arguments[0]&&(i=arguments[0]),i&&e.setOptions(i),e.css({padding:0,position:"relative"}),e._lastCategory=0,e._isAnimating=!1,e._mainArray=e._getFiltrItems(),e._subArrays=e._makeSubarrays(),e._activeArray=e._getCollectionByFilter(e.options.filter),e._uID="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=16*Math.random()|0,i="x"==t?r:3&r|8;return i.toString(16)}),e._setupEvents(),e.options.setupControls&&e._setupControls(),e.filter(e.options.filter),e},filter:function(t){var r=this,i=r._getCollectionByFilter(t);r.options.filter=t,r.trigger("filteringStart");for(var e=r._getArrayOfUniqueItems(r._activeArray,i),n=0;n<e.length;n++)e[n]._filterOut();r._activeArray=i,r._placeItems(i)},shuffle:function(){var t=this;t._mainArray=t._fisherYatesShuffle(t._mainArray),t._subArrays=t._makeSubarrays(),t._placeItems(t._getCollectionByFilter(t.options.filter))},sort:function(t,r){var i=this;t=t||"domIndex",r=r||"asc";var e="domIndex"!==t&&"sortData"!==t&&"w"!==t&&"h"!==t;if(e)for(var n=0;n<i._mainArray.length;n++)i._mainArray[n][t]=i._mainArray[n].data(t);i._mainArray.sort(i._comparator(t,r)),i._subArrays=i._makeSubarrays(),i._placeItems(i._getCollectionByFilter(i.options.filter))},setOptions:function(t){var r=this,i=0;for(var e in t)r.options[e]=t[e];if(r._mainArray&&(t.animationDuration||t.delay||t.easing||t.delayMode))for(i=0;i<r._mainArray.length;i++)r._mainArray[i].css("transition","all "+r.options.animationDuration+"s "+r.options.easing+" "+r._mainArray[i]._calcDelay()+"ms");r.options.filterInCss.transform||(r.options.filterInCss.transform="translate3d(0,0,0)"),r.options.filterOutCss.transform||(r.options.filterOutCss.transform="translate3d(0,0,0)")},_getFiltrItems:function(){var t=this,i=r(t.find(".filtr-item")),n=[];return r.each(i,function(i,o){var a=r(o).extend(e)._init(i,t);n.push(a)}),n},_makeSubarrays:function(){for(var t=this,r=[],i=0;i<t._lastCategory;i++)r.push([]);for(i=0;i<t._mainArray.length;i++)if("object"==typeof t._mainArray[i]._category)for(var e in t._mainArray[i]._category)r[t._mainArray[i]._category[e]-1].push(t._mainArray[i]);else r[t._mainArray[i]._category-1].push(t._mainArray[i]);return r},_setupControls:function(){var t=this;r("*[data-filter]").click(function(){var i=r(this).data("filter");t.options.filter!==i&&t.filter(i)}),r("*[data-shuffle]").click(function(){t.shuffle()}),r("*[data-sortAsc]").click(function(){var i=r("*[data-sortOrder]").val();t.sort(i,"asc")}),r("*[data-sortDesc]").click(function(){var i=r("*[data-sortOrder]").val();t.sort(i,"desc")})},_setupEvents:function(){var i=this;r(t).resize(function(){i._delayEvent(function(){i.trigger("resizeFiltrContainer")},250,i._uID)}),i.on("resizeFiltrContainer",function(){i.filter(i.options.filter)}).on("filteringStart",function(){i.options.callbacks.onFilteringStart()}).on("filteringEnd",function(){i.options.callbacks.onFilteringEnd()})},_calcItemPositions:function(){var t=this,e=t._activeArray,n=0,o=Math.round(t.width()/t.find(".filtr-item").outerWidth()),a=0,s=e[0].outerWidth(),l=0,f=0,u=0,c=0,h=0,p=[];if("packed"===t.options.layout){r.each(t._activeArray,function(t,r){r._updateDimensions()});var _=new i(t.outerWidth());for(_.fit(t._activeArray),c=0;c<e.length;c++)p.push({left:e[c].fit.x,top:e[c].fit.y});n=_.root.h}if("horizontal"===t.options.layout)for(a=1,c=1;c<=e.length;c++)s=e[c-1].outerWidth(),l=e[c-1].outerHeight(),p.push({left:f,top:u}),f+=s,l>n&&(n=l);else if("vertical"===t.options.layout){for(c=1;c<=e.length;c++)l=e[c-1].outerHeight(),p.push({left:f,top:u}),u+=l;n=u}else if("sameHeight"===t.options.layout){a=1;var d=t.outerWidth();for(c=1;c<=e.length;c++){s=e[c-1].width();var y=e[c-1].outerWidth(),g=0;e[c]&&(g=e[c].width()),p.push({left:f,top:u}),h=f+s+g,h>d?(h=0,f=0,u+=e[0].outerHeight(),a++):f+=y}n=a*e[0].outerHeight()}else if("sameWidth"===t.options.layout){for(c=1;c<=e.length;c++){if(p.push({left:f,top:u}),c%o===0&&a++,f+=s,u=0,a>0)for(h=a;h>0;)u+=e[c-o*h].outerHeight(),h--;c%o===0&&(f=0)}for(c=0;o>c;c++){for(var m=0,v=c;e[v];)m+=e[v].outerHeight(),v+=o;m>n?(n=m,m=0):m=0}}else if("sameSize"===t.options.layout){for(c=1;c<=e.length;c++)p.push({left:f,top:u}),f+=s,c%o===0&&(u+=e[0].outerHeight(),f=0);a=Math.ceil(e.length/o),n=a*e[0].outerHeight()}return t.css("height",n),p},_placeItems:function(t){var r=this;r._isAnimating=!0,r._itemPositions=r._calcItemPositions();for(var i=0;i<t.length;i++)t[i]._filterIn(r._itemPositions[i])},_getCollectionByFilter:function(t){var r=this;return"all"===t?r._mainArray:r._subArrays[t-1]},_makeDeepCopy:function(t){var r={};for(var i in t)r[i]=t[i];return r},_comparator:function(t,r){return function(i,e){return"asc"===r?i[t]<e[t]?-1:i[t]>e[t]?1:0:"desc"===r?e[t]<i[t]?-1:e[t]>i[t]?1:0:void 0}},_getArrayOfUniqueItems:function(t,r){var i,e,n=[],o={},a=r.length;for(i=0;a>i;i++)o[r[i].domIndex]=!0;for(a=t.length,i=0;a>i;i++)e=t[i],e.domIndex in o||n.push(e);return n},_delayEvent:function(){var t={};return function(r,i,e){if(null===e)throw Error("UniqueID needed");t[e]&&clearTimeout(t[e]),t[e]=setTimeout(r,i)}}(),_fisherYatesShuffle:function(t){for(var r,i,e=t.length;e;)i=Math.floor(Math.random()*e--),r=t[e],t[e]=t[i],t[i]=r;return t}};var e={_init:function(t,r){var i=this;return i._parent=r,i._category=i._getCategory(),i._lastPos={},i.domIndex=t,i.sortData=i.data("sort"),i.w=0,i.h=0,i._isFilteredOut=!0,i._filteringOut=!1,i._filteringIn=!1,i.css(r.options.filterOutCss).css({"-webkit-backface-visibility":"hidden",perspective:"1000px","-webkit-perspective":"1000px","-webkit-transform-style":"preserve-3d",position:"absolute",transition:"all "+r.options.animationDuration+"s "+r.options.easing+" "+i._calcDelay()+"ms"}),i.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){i._onTransitionEnd()}),i},_updateDimensions:function(){var t=this;t.w=t.outerWidth(),t.h=t.outerHeight()},_calcDelay:function(){var t=this,r=0;return"progressive"===t._parent.options.delayMode?r=t._parent.options.delay*t.domIndex:t.domIndex%2===0&&(r=t._parent.options.delay),r},_getCategory:function(){var t=this,r=t.data("category");if("string"==typeof r){r=r.split(", ");for(var i in r)r[i]>t._parent._lastCategory&&(t._parent._lastCategory=r[i])}else r>t._parent._lastCategory&&(t._parent._lastCategory=r);return r},_onTransitionEnd:function(){var t=this;t._filteringOut?(t._isFilteredOut=!0,t._filteringOut=!1):t._filteringIn&&(t._isFilteredOut=!1,t._filteringIn=!1),t._parent._isAnimating&&(t._parent.trigger("filteringEnd"),t._parent._isAnimating=!1)},_filterOut:function(){var t=this,r=t._parent._makeDeepCopy(t._parent.options.filterOutCss);r.transform+=" translate3d("+t._lastPos.left+"px,"+t._lastPos.top+"px, 0)",t.css(r),t._filteringOut=!0},_filterIn:function(t){var r=this,i=r._parent._makeDeepCopy(r._parent.options.filterInCss);r._filteringIn=!0,r._lastPos=t,i.transform+=" translate3d("+t.left+"px,"+t.top+"px, 0)",r.css(i)}}}(this,jQuery);
